(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(n){if(n.ep)return;n.ep=!0;const l=t(n);fetch(n.href,l)}})();class d{constructor(s,t){this.x=s,this.y=t}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}sub(s){return new d(this.x-s.x,this.y-s.y)}add(s){return new d(this.x+s.x,this.y+s.y)}mul(s){return new d(s*this.x,s*this.y)}normalize(){let s=this.mag();return new d(this.x/s,this.y/s)}withMag(s){const t=this.normalize();return new d(t.x*s,t.y*s)}dot(s){return this.x*s.x+this.y*s.y}distance(s){return this.sub(s).mag()}}const c=document.querySelector("canvas"),e=c==null?void 0:c.getContext("2d"),u=40;var a=(i=>(i[i.ALIVE=0]="ALIVE",i[i.DEAD=1]="DEAD",i))(a||{}),f=(i=>(i[i.PAUSED=0]="PAUSED",i[i.STARTED=1]="STARTED",i[i.OVER=2]="OVER",i))(f||{});class q{constructor(s=0,t=0,r=0,n=1,l=[],o=[],w=[],R=0,I=0){this.width=s,this.height=t,this.status=r,this.scale=n,this.players=l,this.balls=o,this.stars=w,this.frame=R,this.runnerUp=I;for(let E=0;E<70;E++){const g=Math.random()*this.width,L=Math.random()*this.height,O=Math.random()*3,T=Math.random();this.stars.push({x:g,y:L,r:O,alpha:T})}}center(){return new d(this.width/2,this.height/2)}reset(){this.resize(),this.balls.forEach(s=>{s.reset(this)}),this.status=0}resize(){const s=.75*window.innerWidth,t=.6*window.innerHeight;this.width=s,this.height=t,this.scale=Math.sqrt(h.width*h.height)/1e3}setStars(s){for(let t=0;t<s;t++){const r=Math.random()*this.width,n=Math.random()*this.height,l=Math.random()*3,o=Math.random();this.stars.push({x:r,y:n,r:l,alpha:o})}}gameOver(){this.balls.reduce((t,r)=>r.state===0?t+1:t,0)===1&&(this.status=2)}winners(){return this.balls.filter(s=>s.state===0)}}let h=new q(.75*window.innerWidth,.6*window.innerHeight);const v=.4,x=.95,y=.25;function F(i){let s=0,t=0;for(;Math.abs(s)<=.1;)s=Math.random()-.5;for(;Math.abs(t)<=.1;)t=Math.random()-.5;return new d(s,t).withMag(i)}function k(i,s,t){let r=new d(i/2,s/2);const n=new d(i/2,s/2);for(;r.sub(n).mag()<2*t;)r=new d(Math.random()*i,Math.random()*s);return r}function b(i,s){let t=Math.atan2(i.y,i.x);t+=s*(Math.random()-.5);const r=i.mag();return new d(r*Math.cos(t),r*Math.sin(t))}class W{constructor(s=0,t=0,r=0,n=1){this.r=s,this.g=t,this.b=r,this.a=n}color(){return`rgba(${this.r}, ${this.g}, ${this.b}, ${this.a})`}setAlpha(s){this.a=s}random(){this.r=Math.floor(Math.random()*200+55),this.g=Math.floor(Math.random()*200+55),this.b=Math.floor(Math.random()*200+55)}}class ${constructor(s,t=0,r=new d(0,0),n=new d(0,0),l=new W,o="",w=a.ALIVE){this.radius=s,this.id=t,this.pos=r,this.vel=n,this.color=l,this.name=o,this.state=w,l.random(),this.color=l}reset(s){this.state=a.ALIVE,this.pos=k(s.width,s.height,u*s.scale),this.vel=F(4*s.scale),this.radius=u*s.scale,this.color.setAlpha(1)}collide(s){if(s==this||this.state!==a.ALIVE||s.state!==a.ALIVE)return;if(s.pos.sub(this.pos).mag()-(this.radius+s.radius)<0){const n=this.vel.sub(s.vel),l=this.pos.sub(s.pos),o=l.dot(l),w=n.dot(l);this.vel=this.vel.sub(l.mul(w/o)),this.vel.mag()<3&&(this.vel=this.vel.withMag(3)),this.vel.mag()>7&&(this.vel=this.vel.withMag(7)),s.vel=s.vel.add(l.mul(w/o)),s.vel.mag()<3&&(s.vel=s.vel.withMag(3)),s.vel.mag()>7&&(s.vel=s.vel.withMag(7))}}move(s){this.state===a.DEAD&&(this.vel=new d(0,0)),this.pos=this.pos.add(this.vel),this.pos.x<this.radius&&(this.pos.x=this.radius,this.vel.x=-this.vel.x,this.vel=b(this.vel,y)),this.pos.x>s.width-this.radius&&(this.pos.x=s.width-this.radius,this.vel.x=-this.vel.x,this.vel=b(this.vel,y)),this.pos.y<this.radius&&(this.pos.y=this.radius,this.vel.y=-this.vel.y,this.vel=b(this.vel,y)),this.pos.y>s.height-this.radius&&(this.pos.y=s.height-this.radius,this.vel.y=-this.vel.y,this.vel=b(this.vel,y))}gone(s){s.center().sub(this.pos).mag()-this.radius*2-5<0&&s.status!==f.OVER&&(this.state=a.DEAD,s.runnerUp=this.id)}render(s,t){if(!e||!c)return;let r=35/u*this.radius*t*s.scale;e.strokeStyle=this.color.color(),e.lineWidth=6*t*s.scale,this.state===a.DEAD&&(this.radius=this.radius<3?0:this.radius*x,this.radius<3?r=0:r*=x,this.color.setAlpha(x*this.radius/u)),e.beginPath(),e.arc(this.pos.x,this.pos.y,this.radius*t,v,Math.PI-v),e.stroke(),e.beginPath(),e.arc(this.pos.x,this.pos.y,this.radius*t,Math.PI+v,-v),e.stroke(),e.font=`bold ${r}px sans-serif`,e.textAlign="center",e.fillStyle=this.color.color(),e.textBaseline="middle",e.fillText(this.name,this.pos.x,this.pos.y)}}const M=document.getElementById("players");M==null||M.addEventListener("input",function(i){const s=i.target,t=s.value.split(",");h.players=t.map(r=>r.trim()),h.balls=[],h.players.forEach((r,n)=>{let l=new $(u*h.scale);l.name=r,l.id=n,h.balls.push(l)}),h.reset(),localStorage&&localStorage.setItem("players",s.value)});const A=document.getElementById("playButton");A==null||A.addEventListener("click",function(s){window.cancelAnimationFrame(h.frame),h.reset(),h.status=f.STARTED,p(h)});function U(i,s,t,r,n){if(!e)return;e.save(),e.beginPath(),e.translate(i,s),e.moveTo(0,0-t);for(let o=0;o<r;o++)e.rotate(Math.PI/r),e.lineTo(0,0-t*n),e.rotate(Math.PI/r),e.lineTo(0,0-t);e.closePath(),e.fillStyle="rgba(255, 215, 0, 0.7)",e.fill(),e.restore();let l=t/1.4;for(let o=0;o<5;o++)e.fillStyle="rgba(255, 65, 0, 0.31)",e.beginPath(),e.arc(i,s,l*h.scale,0,2*Math.PI),e.closePath(),e.fill(),l/=1.8}function P(){if(e)for(const i of h.stars)e.fillStyle=`rgba(255, 255, 255, ${.5*i.alpha})`,e.beginPath(),e.arc(i.x,i.y,i.r*h.scale,0,2*Math.PI),e.fill()}function V(i){if(!e||!c)return;i.reset(),m(i),window.addEventListener("resize",()=>m(i));const s=localStorage.getItem("players"),t=document.getElementById("players");s&&t&&(t.value=s,i.frame=window.requestAnimationFrame(()=>p(i)),t==null||t.dispatchEvent(new Event("input"))),i.frame=window.requestAnimationFrame(()=>p(i))}function p(i){if(!e)return;e.fillStyle="black",e.strokeStyle="black",e.fillRect(0,0,i.width,i.height),e.strokeRect(0,0,i.width,i.height),P();let s=u;if(i.status===f.STARTED&&U(i.center().x,i.center().y,1.4*s*i.scale,16,.65),i.status!==f.PAUSED){for(let t=0;t<i.balls.length;t++){i.balls[t].gone(i);for(let r=0;r<t;r++)i.balls[t].collide(i.balls[r])}for(let t=0;t<i.balls.length;t++)i.balls[t].move(i),i.balls[t].render(i,1);if(i.gameOver(),i.status===f.OVER){let t=i.winners()[0];if(t.vel=i.center().sub(t.pos),t.vel=t.vel.withMag(3),i.balls[i.runnerUp].radius<3&&t.pos.distance(i.center())<3){window.cancelAnimationFrame(i.frame),D(i);return}}i.frame=window.requestAnimationFrame(()=>p(i)),console.log(i.frame)}}function D(i){if(!e)return;e.fillStyle="black",e.strokeStyle="black",e.fillRect(0,0,i.width,i.height),e.strokeRect(0,0,i.width,i.height),P();const s=i.winners()[0],t=25/u*s.radius*i.scale,r=`${s.name}`;if(e.font=`bold ${t}px sans-serif`,s.color.setAlpha(1),e.fillStyle=s.color.color(),e.textAlign="center",e.textBaseline="middle",e.fillText(r,i.center().x,i.center().y),i.players.includes("Reed")||i.players.includes("reed")){e.save(),e.font="bold 48 sans-serif",e.shadowColor="rgb(190, 190, 190)",e.shadowOffsetX=10,e.shadowOffsetY=10,e.shadowBlur=10;const n=e.createLinearGradient(i.center().x-100,i.center().x+100,150,100);n.addColorStop(0,"rgb(255, 0, 0)"),n.addColorStop(1,"rgb(255, 255, 0)"),e.fillStyle=n,e.fillText("Happy 30th Brithday, Reed!",i.center().x,i.center().y+125),e.restore()}if(s.radius+=.5,s.radius>100){s.reset(i),window.cancelAnimationFrame(i.frame);return}i.frame=window.requestAnimationFrame(()=>D(i))}function m(i){if(!c||!e)return;const s=.75*window.innerWidth,t=.6*window.innerHeight;c.width=Math.floor(s*window.devicePixelRatio),c.height=Math.floor(t*window.devicePixelRatio),c.style.width=s+"px",c.style.height=t+"px",e.scale(window.devicePixelRatio,window.devicePixelRatio),i.width=s,i.height=t,i.scale=Math.sqrt(i.width*i.height)/1e3,i.status!==f.STARTED&&(i.frame=window.requestAnimationFrame(()=>p(i)))}V(h);
