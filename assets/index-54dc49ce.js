(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))s(h);new MutationObserver(h=>{for(const a of h)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(h){const a={};return h.integrity&&(a.integrity=h.integrity),h.referrerPolicy&&(a.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?a.credentials="include":h.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(h){if(h.ep)return;h.ep=!0;const a=n(h);fetch(h.href,a)}})();class l{constructor(t,n){this.x=t,this.y=n}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}sub(t){return new l(this.x-t.x,this.y-t.y)}add(t){return new l(this.x+t.x,this.y+t.y)}mul(t){return new l(t*this.x,t*this.y)}normalize(){let t=this.mag();return new l(this.x/t,this.y/t)}withMag(t){const n=this.normalize();return new l(n.x*t,n.y*t)}dot(t){return this.x*t.x+this.y*t.y}distance(t){return this.sub(t).mag()}unzero(){const t=this.mag();Math.abs(this.x)<.05&&(this.x=.1*t*Math.sign(this.x),this.y=.9*t*Math.sign(this.y)),Math.abs(this.y)<.05&&(this.x=.9*t*Math.sign(this.x),this.y=.1*t*Math.sign(this.y))}}const c=document.querySelector("canvas"),e=c==null?void 0:c.getContext("2d"),u=35;var d=(r=>(r[r.ALIVE=0]="ALIVE",r[r.DEAD=1]="DEAD",r))(d||{}),w=(r=>(r[r.PAUSED=0]="PAUSED",r[r.STARTED=1]="STARTED",r[r.OVER=2]="OVER",r))(w||{});class L{constructor(t=0,n=0,s=0,h=1,a=[],o=[],f=[],A=0,P=0){this.width=t,this.height=n,this.status=s,this.scale=h,this.players=a,this.balls=o,this.stars=f,this.frame=A,this.runnerUp=P;for(let b=0;b<70;b++){const D=Math.random()*this.width,I=Math.random()*this.height,R=Math.random()*3,S=Math.random();this.stars.push({x:D,y:I,r:R,alpha:S})}}reset(){this.resize(),this.balls.forEach(t=>{t.reset(this)}),this.status=0}resize(){const t=.75*window.innerWidth,n=.6*window.innerHeight;this.width=t,this.height=n,this.scale=Math.max(i.width,i.height)/1e3}setStars(t){for(let n=0;n<t;n++){const s=Math.random()*this.width,h=Math.random()*this.height,a=Math.random()*3,o=Math.random();this.stars.push({x:s,y:h,r:a,alpha:o})}}gameOver(){this.balls.reduce((n,s)=>s.state===0?n+1:n,0)===1&&(this.status=2)}winners(){return this.balls.filter(t=>t.state===0)}}let i=new L(.75*window.innerWidth,.6*window.innerHeight);const m=.4,p=.95;function O(r){let t=0,n=0;for(;Math.abs(t)<=.1;)t=Math.random()-.5;for(;Math.abs(n)<=.1;)n=Math.random()-.5;let s=new l(t,n).withMag(r);return s.unzero(),s}function T(r,t,n){let s=new l(r/2,t/2);const h=new l(r/2,t/2);for(;s.sub(h).mag()<2*n;)s=new l(Math.random()*r,Math.random()*t);return s}class z{constructor(t=0,n=0,s=0,h=1){this.r=t,this.g=n,this.b=s,this.a=h}color(){return`rgba(${this.r}, ${this.g}, ${this.b}, ${this.a})`}setAlpha(t){this.a=t}random(){this.r=Math.floor(Math.random()*200+55),this.g=Math.floor(Math.random()*200+55),this.b=Math.floor(Math.random()*200+55)}}class k{constructor(t,n=0,s=new l(0,0),h=new l(0,0),a=new z,o="",f=d.ALIVE){this.radius=t,this.id=n,this.pos=s,this.vel=h,this.color=a,this.name=o,this.state=f,a.random(),this.color=a}reset(t){this.state=d.ALIVE,this.pos=T(t.width,t.height,u*t.scale),this.vel=O(7*t.scale),this.radius=u*t.scale,this.color.setAlpha(1)}collide(t){if(t==this||this.state!==d.ALIVE||t.state!==d.ALIVE)return;if(t.pos.sub(this.pos).mag()-(this.radius+t.radius)<0){const h=this.vel.sub(t.vel),a=this.pos.sub(t.pos),o=a.dot(a),f=h.dot(a);this.vel=this.vel.sub(a.mul(f/o)),this.vel.mag()<3&&(this.vel=this.vel.withMag(3)),this.vel.unzero(),t.vel=t.vel.add(a.mul(f/o)),t.vel.mag()<3&&(t.vel=t.vel.withMag(3)),t.vel.unzero()}}move(){this.state===d.DEAD&&(this.vel=this.vel.mul(-.95)),this.pos=this.pos.add(this.vel),this.pos.x<this.radius&&(this.pos.x=this.radius,this.vel.x=-this.vel.x),this.pos.x>i.width-this.radius&&(this.pos.x=i.width-this.radius,this.vel.x=-this.vel.x),this.pos.y<this.radius&&(this.pos.y=this.radius,this.vel.y=-this.vel.y),this.pos.y>i.height-this.radius&&(this.pos.y=i.height-this.radius,this.vel.y=-this.vel.y)}gone(){new l(i.width/2,i.height/2).sub(this.pos).mag()-this.radius*2-5<0&&i.status!==w.OVER&&(this.state=d.DEAD,i.runnerUp=this.id)}render(t){if(!e||!c)return;let n=20/u*this.radius*t*i.scale;e.strokeStyle=this.color.color(),e.lineWidth=5*t*i.scale,this.state===d.DEAD&&(this.radius=this.radius<3?0:this.radius*p,this.radius<3?n=0:n*=p,this.color.setAlpha(p*this.radius/u)),e.beginPath(),e.arc(this.pos.x,this.pos.y,this.radius*t,m,Math.PI-m),e.stroke(),e.beginPath(),e.arc(this.pos.x,this.pos.y,this.radius*t,Math.PI+m,-m),e.stroke(),e.font=`bold ${n}px sans-serif`,e.textAlign="center",e.fillStyle=this.color.color(),e.textBaseline="middle",e.fillText(this.name,this.pos.x,this.pos.y)}}const y=document.getElementById("players");y==null||y.addEventListener("input",function(r){const t=r.target,n=t.value.split(",");i.players=n.map(s=>s.trim()),i.balls=[],i.players.forEach((s,h)=>{let a=new k(u*i.scale);a.name=s,a.id=h,i.balls.push(a)}),i.reset(),localStorage&&localStorage.setItem("players",t.value)});const v=document.getElementById("playButton");v==null||v.addEventListener("click",function(t){window.cancelAnimationFrame(i.frame),i.reset(),i.status=w.STARTED,g()});function F(r,t,n,s,h){if(e){e.save(),e.beginPath(),e.translate(r,t),e.moveTo(0,0-n);for(let a=0;a<s;a++)e.rotate(Math.PI/s),e.lineTo(0,0-n*h),e.rotate(Math.PI/s),e.lineTo(0,0-n);e.closePath(),e.fillStyle="rgba(255, 215, 0, 0.7)",e.fill(),e.restore()}}function M(){if(e)for(const r of i.stars)e.fillStyle=`rgba(255, 255, 255, ${.5*r.alpha})`,e.beginPath(),e.arc(r.x,r.y,r.r*i.scale,0,2*Math.PI),e.fill()}function $(){if(!e||!c)return;i.reset(),x(),window.addEventListener("resize",x);const r=localStorage.getItem("players"),t=document.getElementById("players");r&&t&&(t.value=r,i.frame=window.requestAnimationFrame(g)),t==null||t.dispatchEvent(new Event("input"))}function g(){if(!e)return;e.fillStyle="black",e.strokeStyle="black",e.fillRect(0,0,i.width,i.height),e.strokeRect(0,0,i.width,i.height),M();const r=i.width/2,t=i.height/2;let n=u;if(i.status===w.STARTED){F(i.width/2,i.height/2,1.4*n*i.scale,16,.65);for(let s=0;s<5;s++)e.fillStyle="rgba(255, 65, 0, 0.31)",e.beginPath(),e.arc(r,t,n*i.scale,0,2*Math.PI),e.closePath(),e.fill(),n/=1.8}if(i.status!==w.PAUSED){for(let s=0;s<i.balls.length;s++){i.balls[s].gone();for(let h=0;h<s;h++)i.balls[s].collide(i.balls[h])}for(let s=0;s<i.balls.length;s++)i.balls[s].move(),i.balls[s].render(1);if(i.gameOver(),i.status===w.OVER){let s=i.winners()[0];if(s.vel=new l(i.width/2,i.height/2).sub(s.pos),s.vel=s.vel.withMag(3),i.balls[i.runnerUp].radius<3&&s.pos.distance(new l(i.width/2,i.height/2))<3){window.cancelAnimationFrame(i.frame),E();return}}i.frame=window.requestAnimationFrame(g)}}function E(){if(!e)return;e.fillStyle="black",e.strokeStyle="black",e.fillRect(0,0,i.width,i.height),e.strokeRect(0,0,i.width,i.height),M();const r=i.width/2,t=i.height/2,n=i.winners()[0],s=20/u*n.radius*i.scale,h=`${n.name}`;if(e.font=`bold ${s}px sans-serif`,n.color.setAlpha(1),e.fillStyle=n.color.color(),e.textAlign="center",e.textBaseline="middle",e.fillText(h,r,t),n.radius+=.5,n.radius>100){n.reset(i),window.cancelAnimationFrame(i.frame);return}i.frame=window.requestAnimationFrame(E)}function x(){if(!c||!e)return;const r=.75*window.innerWidth,t=.6*window.innerHeight;c.width=Math.floor(r*window.devicePixelRatio),c.height=Math.floor(t*window.devicePixelRatio),c.style.width=r+"px",c.style.height=t+"px",e.scale(window.devicePixelRatio,window.devicePixelRatio),i.width=r,i.height=t,i.scale=Math.max(i.width,i.height)/1e3,g()}$();
