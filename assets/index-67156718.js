(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const h of r.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function s(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(l){if(l.ep)return;l.ep=!0;const r=s(l);fetch(l.href,r)}})();class c{constructor(t,s){this.x=t,this.y=s}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}sub(t){return new c(this.x-t.x,this.y-t.y)}add(t){return new c(this.x+t.x,this.y+t.y)}mul(t){return new c(t*this.x,t*this.y)}normalize(){let t=this.mag();return new c(this.x/t,this.y/t)}withMag(t){const s=this.normalize();return new c(s.x*t,s.y*t)}dot(t){return this.x*t.x+this.y*t.y}distance(t){return this.sub(t).mag()}}const a=document.querySelector("canvas"),e=a==null?void 0:a.getContext("2d"),u=40;var d=(i=>(i[i.ALIVE=0]="ALIVE",i[i.DEAD=1]="DEAD",i))(d||{}),f=(i=>(i[i.PAUSED=0]="PAUSED",i[i.STARTED=1]="STARTED",i[i.OVER=2]="OVER",i))(f||{});class q{constructor(t=0,s=0,n=0,l=1,r=[],h=[],w=[],I=0,R=0){this.width=t,this.height=s,this.status=n,this.scale=l,this.players=r,this.balls=h,this.stars=w,this.frame=I,this.runnerUp=R;for(let E=0;E<70;E++){const g=Math.random()*this.width,L=Math.random()*this.height,T=Math.random()*3,O=Math.random();this.stars.push({x:g,y:L,r:T,alpha:O})}}center(){return new c(this.width/2,this.height/2)}reset(){this.resize(),this.balls.forEach(t=>{t.reset(this)}),this.status=0}resize(){const t=.75*window.innerWidth,s=.6*window.innerHeight;this.width=t,this.height=s,this.scale=Math.sqrt(o.width*o.height)/1e3}setStars(t){for(let s=0;s<t;s++){const n=Math.random()*this.width,l=Math.random()*this.height,r=Math.random()*3,h=Math.random();this.stars.push({x:n,y:l,r,alpha:h})}}gameOver(){this.balls.reduce((s,n)=>n.state===0?s+1:s,0)===1&&(this.status=2)}winners(){return this.balls.filter(t=>t.state===0)}}let o=new q(.75*window.innerWidth,.6*window.innerHeight);const v=.4,x=.95,y=.25;function F(i){let t=0,s=0;for(;Math.abs(t)<=.1;)t=Math.random()-.5;for(;Math.abs(s)<=.1;)s=Math.random()-.5;return new c(t,s).withMag(i)}function k(i,t,s){let n=new c(i/2,t/2);const l=new c(i/2,t/2);for(;n.sub(l).mag()<2*s;)n=new c(Math.random()*i,Math.random()*t);return n}function b(i,t){let s=Math.atan2(i.y,i.x);s+=t*(Math.random()-.5);const n=i.mag();return new c(n*Math.cos(s),n*Math.sin(s))}class W{constructor(t=0,s=0,n=0,l=1){this.r=t,this.g=s,this.b=n,this.a=l}color(){return`rgba(${this.r}, ${this.g}, ${this.b}, ${this.a})`}setAlpha(t){this.a=t}random(){this.r=Math.floor(Math.random()*200+55),this.g=Math.floor(Math.random()*200+55),this.b=Math.floor(Math.random()*200+55)}}class ${constructor(t,s=0,n=new c(0,0),l=new c(0,0),r=new W,h="",w=d.ALIVE){this.radius=t,this.id=s,this.pos=n,this.vel=l,this.color=r,this.name=h,this.state=w,r.random(),this.color=r}reset(t){this.state=d.ALIVE,this.pos=k(t.width,t.height,u*t.scale),this.vel=F(4*t.scale),this.radius=u*t.scale,this.color.setAlpha(1)}collide(t){if(t==this||this.state!==d.ALIVE||t.state!==d.ALIVE)return;if(t.pos.sub(this.pos).mag()-(this.radius+t.radius)<0){const l=this.vel.sub(t.vel),r=this.pos.sub(t.pos),h=r.dot(r),w=l.dot(r);this.vel=this.vel.sub(r.mul(w/h)),this.vel.mag()<3&&(this.vel=this.vel.withMag(3)),this.vel.mag()>7&&(this.vel=this.vel.withMag(7)),t.vel=t.vel.add(r.mul(w/h)),t.vel.mag()<3&&(t.vel=t.vel.withMag(3)),t.vel.mag()>7&&(t.vel=t.vel.withMag(7))}}move(t){this.state===d.DEAD&&(this.vel=new c(0,0)),this.pos=this.pos.add(this.vel),this.pos.x<this.radius&&(this.pos.x=this.radius,this.vel.x=-this.vel.x,this.vel=b(this.vel,y)),this.pos.x>t.width-this.radius&&(this.pos.x=t.width-this.radius,this.vel.x=-this.vel.x,this.vel=b(this.vel,y)),this.pos.y<this.radius&&(this.pos.y=this.radius,this.vel.y=-this.vel.y,this.vel=b(this.vel,y)),this.pos.y>t.height-this.radius&&(this.pos.y=t.height-this.radius,this.vel.y=-this.vel.y,this.vel=b(this.vel,y))}gone(t){t.center().sub(this.pos).mag()-this.radius*2-5<0&&t.status!==f.OVER&&(this.state=d.DEAD,t.runnerUp=this.id)}render(t,s){if(!e||!a)return;let n=35/u*this.radius*s*t.scale;e.strokeStyle=this.color.color(),e.lineWidth=6*s*t.scale,this.state===d.DEAD&&(this.radius=this.radius<3?0:this.radius*x,this.radius<3?n=0:n*=x,this.color.setAlpha(x*this.radius/u)),e.beginPath(),e.arc(this.pos.x,this.pos.y,this.radius*s,v,Math.PI-v),e.stroke(),e.beginPath(),e.arc(this.pos.x,this.pos.y,this.radius*s,Math.PI+v,-v),e.stroke(),e.font=`bold ${n}px sans-serif`,e.textAlign="center",e.fillStyle=this.color.color(),e.textBaseline="middle",e.fillText(this.name,this.pos.x,this.pos.y)}}const M=document.getElementById("players");M==null||M.addEventListener("input",function(i){const t=i.target,s=t.value.split(",");o.players=s.map(n=>n.trim()),o.balls=[],o.players.forEach((n,l)=>{let r=new $(u*o.scale);r.name=n,r.id=l,o.balls.push(r)}),o.reset(),localStorage&&localStorage.setItem("players",t.value)});const A=document.getElementById("playButton");A==null||A.addEventListener("click",function(t){window.cancelAnimationFrame(o.frame),o.reset(),o.status=f.STARTED,p(o)});function U(i,t,s,n,l){if(!e)return;e.save(),e.beginPath(),e.translate(i,t),e.moveTo(0,0-s);for(let h=0;h<n;h++)e.rotate(Math.PI/n),e.lineTo(0,0-s*l),e.rotate(Math.PI/n),e.lineTo(0,0-s);e.closePath(),e.fillStyle="rgba(255, 215, 0, 0.7)",e.fill(),e.restore();let r=s/1.4;for(let h=0;h<5;h++)e.fillStyle="rgba(255, 65, 0, 0.31)",e.beginPath(),e.arc(i,t,r*o.scale,0,2*Math.PI),e.closePath(),e.fill(),r/=1.8}function P(){if(e)for(const i of o.stars)e.fillStyle=`rgba(255, 255, 255, ${.5*i.alpha})`,e.beginPath(),e.arc(i.x,i.y,i.r*o.scale,0,2*Math.PI),e.fill()}function V(i){if(!e||!a)return;i.reset(),m(i),window.addEventListener("resize",()=>m(i));const t=localStorage.getItem("players"),s=document.getElementById("players");t&&s&&(s.value=t,i.frame=window.requestAnimationFrame(()=>p(i)),s==null||s.dispatchEvent(new Event("input"))),i.frame=window.requestAnimationFrame(()=>p(i))}function p(i){if(!e)return;e.fillStyle="black",e.strokeStyle="black",e.fillRect(0,0,i.width,i.height),e.strokeRect(0,0,i.width,i.height),P();let t=u;if(i.status===f.STARTED&&U(i.center().x,i.center().y,1.4*t*i.scale,16,.65),i.status!==f.PAUSED){for(let s=0;s<i.balls.length;s++){i.balls[s].gone(i);for(let n=0;n<s;n++)i.balls[s].collide(i.balls[n])}for(let s=0;s<i.balls.length;s++)i.balls[s].move(i),i.balls[s].render(i,1);if(i.gameOver(),i.status===f.OVER){let s=i.winners()[0];if(s.vel=i.center().sub(s.pos),s.vel=s.vel.withMag(3),i.balls[i.runnerUp].radius<3&&s.pos.distance(i.center())<3){window.cancelAnimationFrame(i.frame),D(i);return}}i.frame=window.requestAnimationFrame(()=>p(i))}}function D(i){if(!e)return;e.fillStyle="black",e.strokeStyle="black",e.fillRect(0,0,i.width,i.height),e.strokeRect(0,0,i.width,i.height),P();const t=i.winners()[0],s=25/u*t.radius*i.scale,n=`${t.name}`;if(e.font=`bold ${s}px sans-serif`,t.color.setAlpha(1),e.fillStyle=t.color.color(),e.textAlign="center",e.textBaseline="middle",e.fillText(n,i.center().x,i.center().y),t.radius+=.5,t.radius>100){t.reset(i),window.cancelAnimationFrame(i.frame);return}i.frame=window.requestAnimationFrame(()=>D(i))}function m(i){if(!a||!e)return;const t=.75*window.innerWidth,s=.6*window.innerHeight;a.width=Math.floor(t*window.devicePixelRatio),a.height=Math.floor(s*window.devicePixelRatio),a.style.width=t+"px",a.style.height=s+"px",e.scale(window.devicePixelRatio,window.devicePixelRatio),i.width=t,i.height=s,i.scale=Math.sqrt(i.width*i.height)/1e3,i.status!==f.STARTED&&(i.frame=window.requestAnimationFrame(()=>p(i)))}V(o);
